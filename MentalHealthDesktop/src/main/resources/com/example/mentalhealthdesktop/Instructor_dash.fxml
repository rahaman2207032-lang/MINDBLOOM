<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane minHeight="700.0" minWidth="1200.0" prefHeight="900.0" prefWidth="1400.0" maxHeight="Infinity" maxWidth="Infinity" style="-fx-background-color: #f5f5f5;" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.example.mentalhealthdesktop.controller.Instructor_dash_controller">

    <!-- Top Navigation Bar -->
    <top>
        <VBox>
            <HBox alignment="CENTER_LEFT" spacing="20" style="-fx-background-color: #2c3e50; -fx-padding: 15 20;">
                <Label fx:id="instructorTitle" text="ðŸ‘¨â€âš•ï¸ Instructor Dashboard" textFill="white">
                    <font>
                        <Font name="System Bold" size="22" />
                    </font>
                </Label>
                <Region HBox.hgrow="ALWAYS" />
                <Button onAction="#handleNotifications" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-padding: 8 15; -fx-background-radius: 5; -fx-cursor: hand;" text="ðŸ”” Notifications" />
                <Button onAction="#handleProfile" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-padding: 8 15; -fx-background-radius: 5; -fx-cursor: hand;" text="âš™ï¸ Profile" />
                <Button onAction="#handleLogout" style="-fx-background-color: #c0392b; -fx-text-fill: white; -fx-padding: 8 15; -fx-background-radius: 5; -fx-cursor: hand;" text="ðŸšª Logout" />
            </HBox>

            <!-- Quick Stats Bar -->
            <HBox alignment="CENTER" spacing="30" style="-fx-background-color: #34495e; -fx-padding: 15;">
                <VBox alignment="CENTER" spacing="5">
                    <Label style="-fx-font-size: 12; -fx-text-fill: #bdc3c7;" text="Pending Requests" />
                    <Label fx:id="pendingRequestsLabel" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #e74c3c;" text="0" />
                </VBox>
                <Separator orientation="VERTICAL" prefHeight="50" />
                <VBox alignment="CENTER" spacing="5">
                    <Label style="-fx-font-size: 12; -fx-text-fill: #bdc3c7;" text="Today's Sessions" />
                    <Label fx:id="todaySessionsLabel" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #3498db;" text="0" />
                </VBox>
                <Separator orientation="VERTICAL" prefHeight="50" />
                <VBox alignment="CENTER" spacing="5">
                    <Label style="-fx-font-size: 12; -fx-text-fill: #bdc3c7;" text="Total Clients" />
                    <Label fx:id="totalClientsLabel" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #2ecc71;" text="0" />
                </VBox>
                <Separator orientation="VERTICAL" prefHeight="50" />
                <VBox alignment="CENTER" spacing="5">
                    <Label style="-fx-font-size: 12; -fx-text-fill: #bdc3c7;" text="Available Slots" />
                    <Label fx:id="availableSlotsLabel" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #f39c12;" text="0" />
                </VBox>
            </HBox>
        </VBox>
    </top>

    <!-- Main Content Area -->
    <center>
        <SplitPane dividerPositions="0.35" style="-fx-background-color: #f5f5f5;">

            <!-- Left Panel: Session Requests & Calendar -->
            <VBox spacing="15" style="-fx-padding: 15;">

                <!-- Session Requests Section -->
                <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label style="-fx-font-size: 16; -fx-font-weight: bold;" text="ðŸ“¬ Session Requests" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Button onAction="#refreshRequests" prefHeight="26.0" prefWidth="81.0" style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-padding: 5 15; -fx-background-radius: 4; -fx-cursor: hand; -fx-font-size: 11;" text="Refresh" wrapText="true" />
                    </HBox>

                    <ScrollPane fitToWidth="true" prefHeight="250" style="-fx-background: transparent; -fx-background-color: transparent;">
                        <VBox fx:id="requestsContainer" spacing="10" style="-fx-padding: 5;" />
                    </ScrollPane>
                </VBox>

                <!-- Calendar Section -->
                <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);" VBox.vgrow="ALWAYS">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label style="-fx-font-size: 16; -fx-font-weight: bold;" text="ðŸ“… Session Calendar" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Button onAction="#handleAvailability" style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-padding: 5 15; -fx-background-radius: 4; -fx-cursor: hand; -fx-font-size: 11;" text="Manage Availability" />
                    </HBox>

                    <HBox alignment="CENTER" spacing="10" style="-fx-padding: 10 0;">
                        <Button onAction="#previousWeek" style="-fx-background-color: #ecf0f1; -fx-padding: 5 10; -fx-background-radius: 4; -fx-cursor: hand;" text="â—€" />
                        <Label fx:id="weekLabel" style="-fx-font-size: 14; -fx-font-weight: bold;" text="Week of Jan 1 - Jan 7, 2025" />
                        <Button onAction="#nextWeek" style="-fx-background-color: #ecf0f1; -fx-padding: 5 10; -fx-background-radius: 4; -fx-cursor: hand;" text="â–¶" />
                    </HBox>

                    <ScrollPane fitToWidth="true" style="-fx-background: transparent; -fx-background-color: transparent;" VBox.vgrow="ALWAYS">
                        <VBox fx:id="calendarContainer" spacing="8" style="-fx-padding: 5;" />
                    </ScrollPane>
                </VBox>
            </VBox>

            <!-- Right Panel: Tabbed Interface -->
            <VBox style="-fx-padding: 15;">
                <TabPane fx:id="mainTabPane" style="-fx-background-color: white; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);" VBox.vgrow="ALWAYS">

                    <!-- Tab 1: Client Overview -->
                    <Tab text="ðŸ‘¥ Clients" closable="false">
                        <VBox spacing="15" style="-fx-padding: 15;">
                            <HBox alignment="CENTER_LEFT" spacing="15">
                                <Label text="All Clients" style="-fx-font-size: 16; -fx-font-weight: bold;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button text="ðŸ”„ Refresh" onAction="#refreshClientList" style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-padding: 8 20; -fx-background-radius: 4; -fx-cursor: hand;"/>
                            </HBox>

                            <Label text="Select a client to view their progress:" style="-fx-font-size: 13; -fx-text-fill: #7f8c8d;"/>

                            <ScrollPane fitToWidth="true" style="-fx-background: transparent;" VBox.vgrow="ALWAYS">
                                <VBox fx:id="clientListContainer" spacing="10" style="-fx-padding: 5;"/>
                            </ScrollPane>
                        </VBox>
                    </Tab>

                    <!-- Tab 2: Therapy Notes -->
                    <Tab closable="false" text="ðŸ“ Therapy Notes">
                        <VBox spacing="15" style="-fx-padding: 15;">
                            <HBox alignment="CENTER_LEFT" spacing="15">
                                <Label style="-fx-font-size: 14;" text="Select Client:" />
                                <ComboBox fx:id="clientComboBox" onAction="#selectClientForNotes" prefWidth="250" promptText="Choose a client..." />
                                <Region HBox.hgrow="ALWAYS" />
                                <Button onAction="#createNewNote" style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-padding: 8 20; -fx-background-radius: 4; -fx-cursor: hand;" text="+ New Note" />
                            </HBox>

                            <VBox spacing="10" style="-fx-background-color: #ecf0f1; -fx-background-radius: 5; -fx-padding: 15;" VBox.vgrow="ALWAYS">
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Label style="-fx-font-size: 13;" text="Session Date:" />
                                    <DatePicker fx:id="sessionDatePicker" prefWidth="150" />
                                    <Label style="-fx-font-size: 13; -fx-padding: 0 0 0 15;" text="Session Type:" />
                                    <ComboBox fx:id="sessionTypeComboBox" prefWidth="150" promptText="Type..." />
                                </HBox>

                                <Label style="-fx-font-size: 14; -fx-font-weight: bold; -fx-padding: 5 0 0 0;" text="Private Therapy Notes:" />
                                <TextArea fx:id="therapyNotesArea" promptText="Document your session observations, client progress, concerns, and treatment plan..." style="-fx-padding: 10;" wrapText="true" VBox.vgrow="ALWAYS" />

                                <HBox alignment="CENTER_RIGHT" spacing="10">
                                    <Button onAction="#saveTherapyNote" style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-padding: 10 25; -fx-background-radius: 4; -fx-cursor: hand; -fx-font-size: 13;" text="Save Note" />
                                    <Button onAction="#clearNote" style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-padding: 10 25; -fx-background-radius: 4; -fx-cursor: hand; -fx-font-size: 13;" text="Clear" />
                                </HBox>

                                <Separator style="-fx-padding: 10 0;" />

                                <Label style="-fx-font-size: 14; -fx-font-weight: bold;" text="Previous Notes:" />
                                <ScrollPane fitToWidth="true" prefHeight="200" style="-fx-background: white; -fx-background-color: white;">
                                    <VBox fx:id="previousNotesContainer" spacing="10" style="-fx-padding: 10;" />
                                </ScrollPane>
                            </VBox>
                        </VBox>
                    </Tab>

                    <!-- Tab 3: Messages -->
                    <Tab closable="false" text="ðŸ’¬ Messages">
                        <ScrollPane fitToWidth="true" fitToHeight="true" style="-fx-background: #f5f5f5; -fx-background-color: #f5f5f5;">
                            <BorderPane style="-fx-padding: 15;" minHeight="700" prefHeight="800">
                                <left>
                                    <VBox prefWidth="250" spacing="10" style="-fx-background-color: #ecf0f1; -fx-background-radius: 5; -fx-padding: 10;" BorderPane.alignment="CENTER">
                                        <Label style="-fx-font-size: 14; -fx-font-weight: bold;" text="Conversations" />
                                        <ScrollPane fitToWidth="true" prefHeight="500" minHeight="400" style="-fx-background: transparent;" VBox.vgrow="ALWAYS">
                                            <VBox fx:id="conversationsContainer" spacing="5" style="-fx-padding: 5;" />
                                        </ScrollPane>
                                    </VBox>
                                </left>

                                <center>
                                    <VBox spacing="10" style="-fx-padding: 0 0 0 15;" BorderPane.alignment="CENTER" minHeight="700" prefHeight="800">
                                        <HBox alignment="CENTER_LEFT" style="-fx-background-color: #34495e; -fx-padding: 12; -fx-background-radius: 5;">
                                            <Label fx:id="selectedClientLabel" style="-fx-font-size: 14; -fx-font-weight: bold;" text="Select a client to message" textFill="white" />
                                        </HBox>

                                        <ScrollPane fx:id="messagesScrollPane" fitToWidth="true" prefHeight="550" minHeight="500" style="-fx-background: white; -fx-background-color: white;" VBox.vgrow="ALWAYS">
                                            <VBox fx:id="messagesContainer" spacing="10" style="-fx-padding: 15;" />
                                        </ScrollPane>

                                        <VBox spacing="5" style="-fx-background-color: white; -fx-padding: 10; -fx-background-radius: 5;">
                                            <Label text="Type your message:" style="-fx-font-size: 11; -fx-text-fill: #7f8c8d;"/>
                                            <HBox alignment="CENTER" spacing="10">
                                                <TextArea fx:id="messageTextArea" prefHeight="80" maxHeight="100" minHeight="60" promptText="Type your message here..." style="-fx-padding: 8;" wrapText="true" HBox.hgrow="ALWAYS" />
                                                <Button onAction="#sendMessage" style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-padding: 15 30; -fx-background-radius: 4; -fx-cursor: hand; -fx-font-size: 14; -fx-font-weight: bold;" text="Send" />
                                            </HBox>
                                        </VBox>
                                    </VBox>
                                </center>
                            </BorderPane>
                        </ScrollPane>
                    </Tab>

                    <!-- Tab 4: Analytics -->
                    <Tab closable="false" text="ðŸ“Š Analytics">
                        <VBox spacing="15" style="-fx-padding: 15;">
                            <HBox alignment="CENTER_LEFT" spacing="15">
                                <Label style="-fx-font-size: 16; -fx-font-weight: bold;" text="Performance Overview" />
                                <Region HBox.hgrow="ALWAYS" />
                                <ComboBox fx:id="analyticsTimeRangeCombo" onAction="#updateAnalytics" prefWidth="150" promptText="Last 30 Days" />
                            </HBox>

                            <GridPane hgap="15" vgap="15">
                                <!-- Stats Cards -->
                                <VBox alignment="CENTER" spacing="8" style="-fx-background-color: #3498db; -fx-background-radius: 8; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 5, 0, 0, 2);" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                    <Label style="-fx-font-size: 13;" text="Total Sessions" textFill="white" />
                                    <Label fx:id="totalSessionsLabel" style="-fx-font-size: 32; -fx-font-weight: bold;" text="0" textFill="white" />
                                </VBox>

                                <VBox alignment="CENTER" spacing="8" style="-fx-background-color: #2ecc71; -fx-background-radius: 8; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 5, 0, 0, 2);" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                    <Label style="-fx-font-size: 13;" text="Completed Sessions" textFill="white" />
                                    <Label fx:id="completedSessionsLabel" style="-fx-font-size: 32; -fx-font-weight: bold;" text="0" textFill="white" />
                                </VBox>

                                <VBox alignment="CENTER" spacing="8" style="-fx-background-color: #f39c12; -fx-background-radius: 8; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 5, 0, 0, 2);" GridPane.columnIndex="2" GridPane.rowIndex="0">
                                    <Label style="-fx-font-size: 13;" text="Avg Session Rating" textFill="white" />
                                    <Label fx:id="avgRatingLabel" style="-fx-font-size: 32; -fx-font-weight: bold;" text="0.0" textFill="white" />
                                </VBox>
                        <columnConstraints>
                           <ColumnConstraints />
                           <ColumnConstraints />
                           <ColumnConstraints />
                        </columnConstraints>
                        <rowConstraints>
                           <RowConstraints />
                        </rowConstraints>
                            </GridPane>

                            <ScrollPane fitToWidth="true" style="-fx-background: white;" VBox.vgrow="ALWAYS">
                                <VBox fx:id="analyticsChartsContainer" spacing="20" style="-fx-padding: 15;" />
                            </ScrollPane>
                        </VBox>
                    </Tab>
                </TabPane>
            </VBox>
        </SplitPane>
    </center>

    <!-- Bottom Status Bar -->
    <bottom>
        <HBox alignment="CENTER_LEFT" spacing="15" style="-fx-background-color: #2c3e50; -fx-padding: 8 20;">
            <Label style="-fx-font-size: 12;" text="Status:" textFill="#bdc3c7" />
            <Label fx:id="statusLabel" style="-fx-font-size: 12; -fx-font-weight: bold;" text="Ready" textFill="#2ecc71" />
            <Region HBox.hgrow="ALWAYS" />
            <Label fx:id="lastUpdateLabel" style="-fx-font-size: 11;" text="Last updated: --" textFill="#bdc3c7" />
        </HBox>
    </bottom>

</BorderPane>
